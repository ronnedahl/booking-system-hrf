# Root .htaccess för one.com (fastai.se)
# Hanterar routing mellan frontend och backend

RewriteEngine On

# Security: Block access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Block access to backend .env
RewriteRule ^backend/\.env$ - [F,L]

# API requests go to backend
# /api/login.php → backend/api/login.php
RewriteCond %{REQUEST_URI} ^/api/
RewriteRule ^api/(.*)$ backend/api/$1 [L,QSA]

# Serve static files if they exist (assets, etc)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# SPA fallback - serve index.html for client-side routing
# This catches all other requests (/, /calendar, /schedule/*, etc)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/api/
RewriteRule ^ /index.html [L]
